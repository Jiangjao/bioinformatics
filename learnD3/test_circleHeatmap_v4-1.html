<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .margin30 {
            margin-bottom: 30px;
        }

        .axis path,
        .axis line {
            fill: none;
            stroke: #000;
            shape-rendering: crispEdges;
        }

        path:hover {
            fill: white;
        }

        .tooltip {
            background: #eee;
            box-shadow: 0 0 5px #999999;
            color: #333;
            font-size: 12px;
            left: 130px;
            padding: 10px;
            position: absolute;
            text-align: center;
            top: 95px;
            z-index: 10;
            display: block;
            opacity: 0;
        }
    </style>
</head>

<body>
    <script src="https://d3js.org/d3.v3.js"></script>
    <div id="cont" class="container-fluid text-center">
        <div class="row">
            <div class="col-md-3">
            </div>
            <div class="col-md-6">
                <div id="chart"></div>
            </div>
            <div class="col-md-3">
            </div>
        </div>
    </div>

    <script>
                var dataset =

[{
    "Day": "2016-10-22",
    "Time": "0:00:00",
    "Average": 0.969891134
}, {
    "Day": "2016-10-22",
    "Time": "1:00:00",
    "Average": 0.916218024
}, {
    "Day": "2016-10-22",
    "Time": "2:00:00",
    "Average": 0.933776322
}, {
    "Day": "2016-10-22",
    "Time": "3:00:00",
    "Average": 0.935375822
}, {
    "Day": "2016-10-22",
    "Time": "4:00:00",
    "Average": 0.851685935
}, {
    "Day": "2016-10-22",
    "Time": "5:00:00",
    "Average": 0.708158118
}, {
    "Day": "2016-10-22",
    "Time": "6:00:00",
    "Average": 0.79328731
}, {
    "Day": "2016-10-22",
    "Time": "7:00:00",
    "Average": 0.988681914
}, {
    "Day": "2016-10-22",
    "Time": "8:00:00",
    "Average": 0.653469207
}, {
    "Day": "2016-10-22",
    "Time": "9:00:00",
    "Average": 0.171116158
}, {
    "Day": "2016-10-22",
    "Time": "10:00:00",
    "Average": 0.185425746
}, {
    "Day": "2016-10-22",
    "Time": "11:00:00",
    "Average": 0.724184058
}, {
    "Day": "2016-10-22",
    "Time": "12:00:00",
    "Average": 0.281778782
}, {
    "Day": "2016-10-22",
    "Time": "13:00:00",
    "Average": 0.810961995
}, {
    "Day": "2016-10-22",
    "Time": "14:00:00",
    "Average": 0.182562288
}, {
    "Day": "2016-10-22",
    "Time": "15:00:00",
    "Average": 0.306659218
}, {
    "Day": "2016-10-22",
    "Time": "16:00:00",
    "Average": 0.262867786
}, {
    "Day": "2016-10-22",
    "Time": "17:00:00",
    "Average": 0.651224997
}, {
    "Day": "2016-10-22",
    "Time": "18:00:00",
    "Average": 0.053924618
}, {
    "Day": "2016-10-22",
    "Time": "19:00:00",
    "Average": 0.804157436
}, {
    "Day": "2016-10-22",
    "Time": "20:00:00",
    "Average": 0.996288161
}, {
    "Day": "2016-10-22",
    "Time": "21:00:00",
    "Average": 0.999157842
}, {
    "Day": "2016-10-22",
    "Time": "22:00:00",
    "Average": 0.999360726
}, {
    "Day": "2016-10-22",
    "Time": "23:00:00",
    "Average": 0.999424465
}, {
    "Day": "2016-10-23",
    "Time": "0:00:00",
    "Average": 0.999536399
}, {
    "Day": "2016-10-23",
    "Time": "1:00:00",
    "Average": 0.999532678
}, {
    "Day": "2016-10-23",
    "Time": "2:00:00",
    "Average": 0.881898221
}, {
    "Day": "2016-10-23",
    "Time": "3:00:00",
    "Average": 0.932024524
}, {
    "Day": "2016-10-23",
    "Time": "4:00:00",
    "Average": 0.821856126
}, {
    "Day": "2016-10-23",
    "Time": "5:00:00",
    "Average": 0.69971704
}, {
    "Day": "2016-10-23",
    "Time": "6:00:00",
    "Average": 0.584832441
}, {
    "Day": "2016-10-23",
    "Time": "7:00:00",
    "Average": 0.791939352
}, {
    "Day": "2016-10-23",
    "Time": "8:00:00",
    "Average": 0.191602097
}, {
    "Day": "2016-10-23",
    "Time": "9:00:00",
    "Average": 0.443749611
}, {
    "Day": "2016-10-23",
    "Time": "10:00:00",
    "Average": 0.112807988
}, {
    "Day": "2016-10-23",
    "Time": "11:00:00",
    "Average": 0.862970288
}, {
    "Day": "2016-10-23",
    "Time": "12:00:00",
    "Average": -0.159894786
}, {
    "Day": "2016-10-23",
    "Time": "13:00:00",
    "Average": 0.27077585
}, {
    "Day": "2016-10-23",
    "Time": "14:00:00",
    "Average": 0.41846599
}, {
    "Day": "2016-10-23",
    "Time": "15:00:00",
    "Average": 0.245919838
}, {
    "Day": "2016-10-23",
    "Time": "16:00:00",
    "Average": 0.639089128
}, {
    "Day": "2016-10-23",
    "Time": "17:00:00",
    "Average": 0.908434064
}, {
    "Day": "2016-10-23",
    "Time": "18:00:00",
    "Average": -0.308801718
}, {
    "Day": "2016-10-23",
    "Time": "19:00:00",
    "Average": 0.638730315
}, {
    "Day": "2016-10-23",
    "Time": "20:00:00",
    "Average": 0.99329318
}, {
    "Day": "2016-10-23",
    "Time": "21:00:00",
    "Average": 0.999333149
}, {
    "Day": "2016-10-23",
    "Time": "22:00:00",
    "Average": 0.999169182
}, {
    "Day": "2016-10-23",
    "Time": "23:00:00",
    "Average": 0.999429383
}, {
    "Day": "2016-10-24",
    "Time": "0:00:00",
    "Average": 0.999175267
}, {
    "Day": "2016-10-24",
    "Time": "1:00:00",
    "Average": 0.998963684
}, {
    "Day": "2016-10-24",
    "Time": "2:00:00",
    "Average": 0.999478702
}, {
    "Day": "2016-10-24",
    "Time": "3:00:00",
    "Average": 0.960087267
}, {
    "Day": "2016-10-24",
    "Time": "4:00:00",
    "Average": 0.949187905
}, {
    "Day": "2016-10-24",
    "Time": "5:00:00",
    "Average": -0.339041285
}, {
    "Day": "2016-10-24",
    "Time": "6:00:00",
    "Average": 0.295181291
}, {
    "Day": "2016-10-24",
    "Time": "7:00:00",
    "Average": 0.128635277
}, {
    "Day": "2016-10-24",
    "Time": "8:00:00",
    "Average": 0.982508364
}, {
    "Day": "2016-10-24",
    "Time": "9:00:00",
    "Average": 0.977814752
}, {
    "Day": "2016-10-24",
    "Time": "10:00:00",
    "Average": 0.809665585
}, {
    "Day": "2016-10-24",
    "Time": "11:00:00",
    "Average": 0.648068162
}, {
    "Day": "2016-10-24",
    "Time": "12:00:00",
    "Average": 0.812559532
}, {
    "Day": "2016-10-24",
    "Time": "13:00:00",
    "Average": 0.954865661
}, {
    "Day": "2016-10-24",
    "Time": "14:00:00",
    "Average": 0.8971414
}, {
    "Day": "2016-10-24",
    "Time": "15:00:00",
    "Average": 0.808797442
}, {
    "Day": "2016-10-24",
    "Time": "16:00:00",
    "Average": 0.399305729
}, {
    "Day": "2016-10-24",
    "Time": "17:00:00",
    "Average": -0.896724755
}, {
    "Day": "2016-10-24",
    "Time": "18:00:00",
    "Average": -0.530474392
}, {
    "Day": "2016-10-24",
    "Time": "19:00:00",
    "Average": 0.825396025
}, {
    "Day": "2016-10-24",
    "Time": "20:00:00",
    "Average": 0.999483386
}, {
    "Day": "2016-10-24",
    "Time": "21:00:00",
    "Average": 0.998930358
}, {
    "Day": "2016-10-24",
    "Time": "22:00:00",
    "Average": 0.998902723
}, {
    "Day": "2016-10-24",
    "Time": "23:00:00",
    "Average": 0.998718033
}, {
    "Day": "2016-10-25",
    "Time": "0:00:00",
    "Average": 0.34896482
}, {
    "Day": "2016-10-25",
    "Time": "1:00:00",
    "Average": 0.996568297
}, {
    "Day": "2016-10-25",
    "Time": "2:00:00",
    "Average": 0.894943299
}, {
    "Day": "2016-10-25",
    "Time": "3:00:00",
    "Average": 0.63441929
}, {
    "Day": "2016-10-25",
    "Time": "4:00:00",
    "Average": 0.773203792
}, {
    "Day": "2016-10-25",
    "Time": "5:00:00",
    "Average": 0.674335006
}, {
    "Day": "2016-10-25",
    "Time": "6:00:00",
    "Average": 0.799208912
}, {
    "Day": "2016-10-25",
    "Time": "7:00:00",
    "Average": 0.38407372
}, {
    "Day": "2016-10-25",
    "Time": "8:00:00",
    "Average": 0.990159471
}, {
    "Day": "2016-10-25",
    "Time": "9:00:00",
    "Average": 0.951533012
}, {
    "Day": "2016-10-25",
    "Time": "10:00:00",
    "Average": 0.807654436
}, {
    "Day": "2016-10-25",
    "Time": "11:00:00",
    "Average": 0.275606308
}, {
    "Day": "2016-10-25",
    "Time": "12:00:00",
    "Average": 0.54954288
}, {
    "Day": "2016-10-25",
    "Time": "13:00:00",
    "Average": -0.140555408
}, {
    "Day": "2016-10-25",
    "Time": "14:00:00",
    "Average": 0.379065392
}, {
    "Day": "2016-10-25",
    "Time": "15:00:00",
    "Average": -0.592452679
}, {
    "Day": "2016-10-25",
    "Time": "16:00:00",
    "Average": 0.721017485
}, {
    "Day": "2016-10-25",
    "Time": "17:00:00",
    "Average": -0.120732899
}, {
    "Day": "2016-10-25",
    "Time": "18:00:00",
    "Average": 0.375226216
}, {
    "Day": "2016-10-25",
    "Time": "19:00:00",
    "Average": 0.43537517
}, {
    "Day": "2016-10-25",
    "Time": "20:00:00",
    "Average": 0.978913563
}, {
    "Day": "2016-10-25",
    "Time": "21:00:00",
    "Average": 0.999487121
}, {
    "Day": "2016-10-25",
    "Time": "22:00:00",
    "Average": 0.998796699
}, {
    "Day": "2016-10-25",
    "Time": "23:00:00",
    "Average": 0.999035806
}, {
    "Day": "2016-10-26",
    "Time": "0:00:00",
    "Average": 0.999002226
}, {
    "Day": "2016-10-26",
    "Time": "1:00:00",
    "Average": 0.998962362
}, {
    "Day": "2016-10-26",
    "Time": "2:00:00",
    "Average": 0.999508864
}, {
    "Day": "2016-10-26",
    "Time": "3:00:00",
    "Average": 0.999430909
}, {
    "Day": "2016-10-26",
    "Time": "4:00:00",
    "Average": 0.872319823
}, {
    "Day": "2016-10-26",
    "Time": "5:00:00",
    "Average": -0.500098865
}, {
    "Day": "2016-10-26",
    "Time": "6:00:00",
    "Average": 0.884718182
}, {
    "Day": "2016-10-26",
    "Time": "7:00:00",
    "Average": 0.187257841
}, {
    "Day": "2016-10-26",
    "Time": "8:00:00",
    "Average": 0.748722821
}, {
    "Day": "2016-10-26",
    "Time": "9:00:00",
    "Average": -0.314047537
}, {
    "Day": "2016-10-26",
    "Time": "10:00:00",
    "Average": 0.38328468
}, {
    "Day": "2016-10-26",
    "Time": "11:00:00",
    "Average": 0.338633768
}, {
    "Day": "2016-10-26",
    "Time": "12:00:00",
    "Average": 0.742048733
}, {
    "Day": "2016-10-26",
    "Time": "13:00:00",
    "Average": 0.914171247
}, {
    "Day": "2016-10-26",
    "Time": "14:00:00",
    "Average": 0.945862628
}, {
    "Day": "2016-10-26",
    "Time": "15:00:00",
    "Average": 0.338013086
}, {
    "Day": "2016-10-26",
    "Time": "16:00:00",
    "Average": 0.149687275
}, {
    "Day": "2016-10-26",
    "Time": "17:00:00",
    "Average": 0.352206289
}, {
    "Day": "2016-10-26",
    "Time": "18:00:00",
    "Average": 0.341103795
}, {
    "Day": "2016-10-26",
    "Time": "19:00:00",
    "Average": 0.466675985
}, {
    "Day": "2016-10-26",
    "Time": "20:00:00",
    "Average": 0.669826054
}, {
    "Day": "2016-10-26",
    "Time": "21:00:00",
    "Average": 0.99943469
}, {
    "Day": "2016-10-26",
    "Time": "22:00:00",
    "Average": 0.999406276
}, {
    "Day": "2016-10-26",
    "Time": "23:00:00",
    "Average": 0.999106811
}, {
    "Day": "2016-10-27",
    "Time": "0:00:00",
    "Average": 0.999241057
}, {
    "Day": "2016-10-27",
    "Time": "1:00:00",
    "Average": 0.999192176
}, {
    "Day": "2016-10-27",
    "Time": "2:00:00",
    "Average": 0.999320245
}, {
    "Day": "2016-10-27",
    "Time": "3:00:00",
    "Average": 0.999419671
}, {
    "Day": "2016-10-27",
    "Time": "4:00:00",
    "Average": 0.897699972
}, {
    "Day": "2016-10-27",
    "Time": "5:00:00",
    "Average": 0.840491494
}, {
    "Day": "2016-10-27",
    "Time": "6:00:00",
    "Average": 0.859329098
}, {
    "Day": "2016-10-27",
    "Time": "7:00:00",
    "Average": 0.90962599
}, {
    "Day": "2016-10-27",
    "Time": "8:00:00",
    "Average": 0.930740485
}, {
    "Day": "2016-10-27",
    "Time": "9:00:00",
    "Average": 0.719432854
}, {
    "Day": "2016-10-27",
    "Time": "10:00:00",
    "Average": -0.281915894
}, {
    "Day": "2016-10-27",
    "Time": "11:00:00",
    "Average": -0.045717954
}, {
    "Day": "2016-10-27",
    "Time": "12:00:00",
    "Average": -0.040819929
}, {
    "Day": "2016-10-27",
    "Time": "13:00:00",
    "Average": 0.767412491
}, {
    "Day": "2016-10-27",
    "Time": "14:00:00",
    "Average": 0.56852041
}, {
    "Day": "2016-10-27",
    "Time": "15:00:00",
    "Average": 0.87944526
}, {
    "Day": "2016-10-27",
    "Time": "16:00:00",
    "Average": 0.635073303
}, {
    "Day": "2016-10-27",
    "Time": "17:00:00",
    "Average": 0.159631593
}, {
    "Day": "2016-10-27",
    "Time": "18:00:00",
    "Average": -0.36532701
}, {
    "Day": "2016-10-27",
    "Time": "19:00:00",
    "Average": 0.902577964
}, {
    "Day": "2016-10-27",
    "Time": "20:00:00",
    "Average": 0.892289366
}, {
    "Day": "2016-10-27",
    "Time": "21:00:00",
    "Average": 0.998451361
}, {
    "Day": "2016-10-27",
    "Time": "22:00:00",
    "Average": 0.999516821
}, {
    "Day": "2016-10-27",
    "Time": "23:00:00",
    "Average": 0.999223124
}, {
    "Day": "2016-10-28",
    "Time": "0:00:00",
    "Average": 0.999196202
}, {
    "Day": "2016-10-28",
    "Time": "1:00:00",
    "Average": 0.99943517
}, {
    "Day": "2016-10-28",
    "Time": "2:00:00",
    "Average": 0.998540252
}, {
    "Day": "2016-10-28",
    "Time": "3:00:00",
    "Average": 0.999532268
}, {
    "Day": "2016-10-28",
    "Time": "4:00:00",
    "Average": 0.999371504
}, {
    "Day": "2016-10-28",
    "Time": "5:00:00",
    "Average": 0.845982571
}, {
    "Day": "2016-10-28",
    "Time": "6:00:00",
    "Average": 0.855708622
}, {
    "Day": "2016-10-28",
    "Time": "7:00:00",
    "Average": 0.427117949
}, {
    "Day": "2016-10-28",
    "Time": "8:00:00",
    "Average": 0.947572789
}, {
    "Day": "2016-10-28",
    "Time": "9:00:00",
    "Average": 0.710845328
}, {
    "Day": "2016-10-28",
    "Time": "10:00:00",
    "Average": 0.979177891
}, {
    "Day": "2016-10-28",
    "Time": "11:00:00",
    "Average": 0.767125493
}, {
    "Day": "2016-10-28",
    "Time": "12:00:00",
    "Average": 0.22070972
}, {
    "Day": "2016-10-28",
    "Time": "13:00:00",
    "Average": 0.955964611
}, {
    "Day": "2016-10-28",
    "Time": "14:00:00",
    "Average": 0.437379032
}, {
    "Day": "2016-10-28",
    "Time": "15:00:00",
    "Average": 0.572119279
}, {
    "Day": "2016-10-28",
    "Time": "16:00:00",
    "Average": 0.023635303
}, {
    "Day": "2016-10-28",
    "Time": "17:00:00",
    "Average": 0.77801158
}, {
    "Day": "2016-10-28",
    "Time": "18:00:00",
    "Average": 0.026233949
}, {
    "Day": "2016-10-28",
    "Time": "19:00:00",
    "Average": 0.893743871
}, {
    "Day": "2016-10-28",
    "Time": "20:00:00",
    "Average": 0.931683898
}, {
    "Day": "2016-10-28",
    "Time": "21:00:00",
    "Average": 0.995607403
}, {
    "Day": "2016-10-28",
    "Time": "22:00:00",
    "Average": 0.999411436
}, {
    "Day": "2016-10-28",
    "Time": "23:00:00",
    "Average": 0.999244343
}, {
    "Day": "2016-10-29",
    "Time": "0:00:00",
    "Average": 0.999144193
}, {
    "Day": "2016-10-29",
    "Time": "1:00:00",
    "Average": 0.999175064
}, {
    "Day": "2016-10-29",
    "Time": "2:00:00",
    "Average": 0.999358134
}, {
    "Day": "2016-10-29",
    "Time": "3:00:00",
    "Average": 0.999324622
}, {
    "Day": "2016-10-29",
    "Time": "4:00:00",
    "Average": 0.999183361
}, {
    "Day": "2016-10-29",
    "Time": "5:00:00",
    "Average": 0.997701265
}, {
    "Day": "2016-10-29",
    "Time": "6:00:00",
    "Average": 0.193188314
}, {
    "Day": "2016-10-29",
    "Time": "7:00:00",
    "Average": 0.362023129
}, {
    "Day": "2016-10-29",
    "Time": "8:00:00",
    "Average": 0.710273557
}, {
    "Day": "2016-10-29",
    "Time": "9:00:00",
    "Average": 0.218587407
}, {
    "Day": "2016-10-29",
    "Time": "10:00:00",
    "Average": 0.254116699
}, {
    "Day": "2016-10-29",
    "Time": "11:00:00",
    "Average": 0.360555619
}, {
    "Day": "2016-10-29",
    "Time": "12:00:00",
    "Average": 0.82039974
}, {
    "Day": "2016-10-29",
    "Time": "13:00:00",
    "Average": 0.709718351
}, {
    "Day": "2016-10-29",
    "Time": "14:00:00",
    "Average": 0.329563071
}, {
    "Day": "2016-10-29",
    "Time": "15:00:00",
    "Average": 0.324728648
}, {
    "Day": "2016-10-29",
    "Time": "16:00:00",
    "Average": 0.104471717
}, {
    "Day": "2016-10-29",
    "Time": "17:00:00",
    "Average": -0.225612728
}, {
    "Day": "2016-10-29",
    "Time": "18:00:00",
    "Average": -0.254633332
}, {
    "Day": "2016-10-29",
    "Time": "19:00:00",
    "Average": 0.691683787
}, {
    "Day": "2016-10-29",
    "Time": "20:00:00",
    "Average": 0.856442446
}, {
    "Day": "2016-10-29",
    "Time": "21:00:00",
    "Average": 0.657394008
}, {
    "Day": "2016-10-29",
    "Time": "22:00:00",
    "Average": 0.999113376
}, {
    "Day": "2016-10-29",
    "Time": "23:00:00",
    "Average": 0.999317588
}, {
    "Day": "2016-10-30",
    "Time": "0:00:00",
    "Average": 0.999054977
}, {
    "Day": "2016-10-30",
    "Time": "1:00:00",
    "Average": 0.999005736
}, {
    "Day": "2016-10-30",
    "Time": "2:00:00",
    "Average": 0.999268194
}, {
    "Day": "2016-10-30",
    "Time": "3:00:00",
    "Average": 0.999477157
}, {
    "Day": "2016-10-30",
    "Time": "4:00:00",
    "Average": 0.999500666
}, {
    "Day": "2016-10-30",
    "Time": "5:00:00",
    "Average": 0.841335892
}, {
    "Day": "2016-10-30",
    "Time": "6:00:00",
    "Average": 0.849157868
}, {
    "Day": "2016-10-30",
    "Time": "7:00:00",
    "Average": 0.903315232
}, {
    "Day": "2016-10-30",
    "Time": "8:00:00",
    "Average": 0.628510543
}, {
    "Day": "2016-10-30",
    "Time": "9:00:00",
    "Average": 0.692835887
}, {
    "Day": "2016-10-30",
    "Time": "10:00:00",
    "Average": 0.879148233
}, {
    "Day": "2016-10-30",
    "Time": "11:00:00",
    "Average": 0.656550851
}, {
    "Day": "2016-10-30",
    "Time": "12:00:00",
    "Average": 0.666586143
}, {
    "Day": "2016-10-30",
    "Time": "13:00:00",
    "Average": 0.871021005
}, {
    "Day": "2016-10-30",
    "Time": "14:00:00",
    "Average": 0.810344826
}, {
    "Day": "2016-10-30",
    "Time": "15:00:00",
    "Average": 0.895859232
}, {
    "Day": "2016-10-30",
    "Time": "16:00:00",
    "Average": -0.442800707
}, {
    "Day": "2016-10-30",
    "Time": "17:00:00",
    "Average": 0.276780281
}, {
    "Day": "2016-10-30",
    "Time": "18:00:00",
    "Average": 0.711015244
}, {
    "Day": "2016-10-30",
    "Time": "19:00:00",
    "Average": 0.8673588
}, {
    "Day": "2016-10-30",
    "Time": "20:00:00",
    "Average": 0.35743309
}, {
    "Day": "2016-10-30",
    "Time": "21:00:00",
    "Average": 0.842565318
}, {
    "Day": "2016-10-30",
    "Time": "22:00:00",
    "Average": 0.992020246
}, {
    "Day": "2016-10-30",
    "Time": "23:00:00",
    "Average": 0.999205778
}];

    </script>
    <script>

        var radial_labels = ['2016-10-22', '2016-10-23', '2016-10-24', '2016-10-25', '2016-10-26', '2016-10-27', '2016-10-28', '2016-10-29', '2016-10-30'];

        var segment_labels = ['0:00', '1:00', '2:00', '3:00', '4:00', '5:00', '6:00', '7:00', '8:00', '9:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00', '21:00', '22:00', '23:00'];

        loadCircularHeatMap(data, "#chart", radial_labels, segment_labels);

        var numSegments = 24;
        function loadCircularHeatMap(dataset, dom_element_to_append_to, radial_labels, segment_labels) {

            var margin = {
                top: 50,
                right: 50,
                bottom: 50,
                left: 50
            };

            var width = 1000 - margin.left - margin.right;

            var height = width;
            var innerRadius = 100; // width/14;

            var segmentHeight = (width - margin.top - margin.bottom - 2 * innerRadius) / (2 * radial_labels.length);

            var chart = circularHeatChart()
                .innerRadius(innerRadius)
                .segmentHeight(segmentHeight)
                .domain([0, 0.5, 1])
                .range(["#ffffd9", "#7fcdbb", "#225ea8"])
                .radialLabels(radial_labels)
                .segmentLabels(segment_labels);

            chart.accessor(function (d) {
                return d.Average;
            })

            var svg = d3.select(dom_element_to_append_to)
                .selectAll('svg')
                .data([dataset])
                .enter()
                .append('svg')
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append('g')
                .attr("transform",
                    "translate(" + ((width) / 2 - (radial_labels.length * segmentHeight + innerRadius)) + "," + margin.top + ")")
                .call(chart);




            var tooltip = d3.select(dom_element_to_append_to)
                .append('div')
                .attr('class', 'tooltip');

            tooltip.append('div')
                .attr('class', 'time');
            tooltip.append('div')
                .attr('class', 'average');
            tooltip.append('div')
                .attr('class', 'day');

            svg.selectAll("path")
                .on('mouseover', function (d, i) {
                    var targetIndex = Math.floor(i / numSegments); //the layer you are hovering
                    var zoomSize = 10; //inner 10px and outer 10px
                    var layerCnt = data.length / numSegments;


                    d3.selectAll("path.segment") //.arc indicates segment
                        .transition().duration(200) //transtion effect
                        .attr("d", d3.svg.arc() //set d again
                            .innerRadius(ir)
                            .outerRadius(or)
                            .startAngle(sa)
                            .endAngle(ea))


                    function getRadius(floor) {
                        if (floor === 0) { //inner radius doesn't change
                            return innerRadius;
                        }
                        if (floor === layerCnt) { //outer radius doesn't change
                            return innerRadius + layerCnt * segmentHeight;
                        }
                        if (floor <= targetIndex) { //it's math
                            return innerRadius + floor * segmentHeight - zoomSize * (floor / targetIndex);
                        } else { //math again
                            return innerRadius + floor * segmentHeight + zoomSize * ((layerCnt - floor) / (layerCnt - targetIndex));
                        }
                    }

                    function ir(d, i) {
                        return getRadius(Math.floor(i / numSegments));
                    }

                    function or(d, i) {
                        return getRadius(Math.floor(i / numSegments) + 1);
                    }
                    // increase the segment height of the one being hovered as well as all others of the same date
                    // while decreasing the height of all others accordingly

                    d3.selectAll("path.segment-" + d.Day).style("opacity", function (p) {
                        return 0.6
                    });

                    tooltip.select('.time').html("<b> Time: " + d.Time + "</b>");
                    tooltip.select('.day').html("<b> Date: " + d.Day + "</b>");
                    tooltip.select('.average').html("<b> Value: " + d.Average + "</b>");
                    tooltip.style('display', 'block');
                    tooltip.style('opacity', 2);
                })
                .on('mousemove', function (d) {
                    tooltip.style('top', (d3.event.layerY + 10) + 'px')
                        .style('left', (d3.event.layerX - 25) + 'px');
                })
                .on('mouseout', function (d, i) {
                    tooltip.style('display', 'none');
                    tooltip.style('opacity', 0);
                    //  var time = d.Time;
                    //  var timeCleaned = time.split(":").join("-");
                    //  var segment = d3.select("#segment-"+d.Day +"-"+timeCleaned); //designate selector variable for brevity
                    //  var fillcolor = segment.select("desc").text();  //access original color from desc
                    //  segment.style("fill", fillcolor);

                    d3.selectAll("path.segment-" + d.Day).style("opacity", function (p) {
                        return 1
                    });
                    var targetIndex = Math.floor(i / numSegments);
                    var zoomSize = 10;
                    var layerCnt = data.length / numSegments;


                    d3.selectAll("path.segment")
                        .transition().duration(200)
                        .attr("d", d3.svg.arc()
                            .innerRadius(ir)
                            .outerRadius(or)
                            .startAngle(sa)
                            .endAngle(ea))

                    function getRadius(floor) {
                        return innerRadius + floor * segmentHeight;
                    }

                    function ir(d, i) {

                        return getRadius(Math.floor(i / numSegments));
                    }

                    function or(d, i) {
                        return getRadius(Math.floor(i / numSegments) + 1);
                    }
                })
                .append("desc") //append the current color as a desc element
                .text(function (d) {
                    var color = d3.scale.linear().domain([0, 0.5, 1]).range(["#ffffd9", "#7fcdbb", "#225ea8"]);
                    // how to access a function within reusable charts
                    console.log(color(d.Average));
                    return color(d.Average);
                });
        }

        function circularHeatChart() {
            var margin = {
                top: 20,
                right: 50,
                bottom: 50,
                left: 20
            },
                innerRadius = 20,
                segmentHeight = 20,
                numSegments = 24;
            domain = null,
                range = ["white", "red"],
                accessor = function (d) {
                    return d;
                },
                radialLabels = segmentLabels = [];

            function chart(selection) {
                selection.each(function (data) {
                    var svg = d3.select(this);

                    var offset = innerRadius + Math.ceil(data.length / numSegments) * segmentHeight;
                    g = svg.append("g")
                        .classed("circular-heat", true)
                        .attr("transform", "translate(" + parseInt(margin.left + offset) + "," + parseInt(margin.top + offset) + ")");

                    var autoDomain = false;
                    if (domain === null) {
                        domain = d3.extent(data, accessor);
                        autoDomain = true;
                    }
                    var color = d3.scale.linear().domain(domain).range(range);
                    if (autoDomain)
                        domain = null;

                    g.selectAll("path").data(data)
                        .enter().append("path")
                        // .attr("class","segment")
                        .attr("class", function (d) {
                            return "segment-" + d.Day + " segment"
                        })
                        .attr("id", function (d) {
                            var time = d.Time;
                            var timeCleaned = time.split(":").join("-");
                            return "segment-" + d.Day + "-" + timeCleaned;
                        })
                        .attr("d", d3.svg.arc().innerRadius(ir).outerRadius(or).startAngle(sa).endAngle(ea))
                        .attr("stroke", function (d) {
                            return '#252525';
                        })
                        .attr("fill", function (d) {
                            return color(accessor(d));
                        });

                    // Unique id so that the text path defs are unique - is there a better way to do this?
                    var id = d3.selectAll(".circular-heat")[0].length;


                    //Segment labels
                    var segmentLabelOffset = 5;
                    var r = innerRadius + Math.ceil(data.length / numSegments) * segmentHeight + segmentLabelOffset;
                    labels = svg.append("g")
                        .classed("labels", true)
                        .classed("segment", true)
                        .attr("transform", "translate(" + parseInt(margin.left + offset) + "," + parseInt(margin.top + offset) + ")");

                    labels.append("def")
                        .append("path")
                        .attr("id", "segment-label-path-" + id)
                        .attr("d", "m0 -" + r + " a" + r + " " + r + " 0 1 1 -1 0");

                    labels.selectAll("text")
                        .data(segmentLabels).enter()
                        .append("text")
                        .append("textPath")
                        .attr("xlink:href", "#segment-label-path-" + id)
                        .style("font-size", "12px")
                        .attr("startOffset", function (d, i) {
                            return i * 100 / numSegments + 1.5 + "%";
                        })
                        .text(function (d) {
                            return d;
                        });
                });

            }

            /* Arc functions */
            ir = function (d, i) {
                return innerRadius + Math.floor(i / numSegments) * segmentHeight;
            }
            or = function (d, i) {
                return innerRadius + segmentHeight + Math.floor(i / numSegments) * segmentHeight;
            }
            sa = function (d, i) {
                return (i * 2 * Math.PI) / numSegments;
            }
            ea = function (d, i) {
                return ((i + 1) * 2 * Math.PI) / numSegments;
            }

            /* Configuration getters/setters */
            chart.margin = function (_) {
                if (!arguments.length) return margin;
                margin = _;
                return chart;
            };

            chart.innerRadius = function (_) {
                if (!arguments.length) return innerRadius;
                innerRadius = _;
                return chart;
            };

            chart.numSegments = function (_) {
                if (!arguments.length) return numSegments;
                numSegments = _;
                return chart;
            };

            chart.segmentHeight = function (_) {
                if (!arguments.length) return segmentHeight;
                segmentHeight = _;
                return chart;
            };

            chart.domain = function (_) {
                if (!arguments.length) return domain;
                domain = _;
                return chart;
            };

            chart.range = function (_) {
                if (!arguments.length) return range;
                range = _;
                return chart;
            };

            chart.radialLabels = function (_) {
                if (!arguments.length) return radialLabels;
                if (_ == null) _ = [];
                radialLabels = _;
                return chart;
            };

            chart.segmentLabels = function (_) {
                if (!arguments.length) return segmentLabels;
                if (_ == null) _ = [];
                segmentLabels = _;
                return chart;
            };

            chart.accessor = function (_) {
                if (!arguments.length) return accessor;
                accessor = _;
                return chart;
            };

            return chart;
        }
    </script>
</body>

</html>