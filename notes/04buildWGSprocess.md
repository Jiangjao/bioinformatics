# 全基因组测序分析 chapter 04
    流程的具体形式其实是次要的，WGS本质上只是一个技术手段
    重要的是，明白自己的问题是什么，预期是什么，再选择合适的技术

![avatar](./../images/processdure.jpg)   

-   原始数据质量控制
-   数据预处理
-   变异检测

## 0.准备阶段
    github上有开源的软件
    BWA  最权威，使用最广的NGS软件，目前已经更新到0.7.16版本

    Samtools(https://broadinstitute.github.io.picard)   是一个专门用于处理对比数据的工具，由BWA的作者(Ih3)编写

    Picard  由组学研究中心-Broad研究所开发的一款强大的NGS数据处理工具，功能方面和Samtools
    有些重叠，但更多的是互补，java编写的，直接下载最新的.jar包就行

    GATK   同样是Broad研究所开发的，是目前最广的基因变异检测工具


## 1.原始数据质量控制
    略

## 2.数据预处理
    我们已经知道NGS测序下来的短序列(read)存储于FASTQ文件中。
    虽然之前它们都来源于有序基因组，但经过DNA建库和测序后，
    文件中不同的read之间的前后顺序关系就已经完全丢失了。
    因此，FASTQ文件中紧挨着的两条read之间没有任何的位置关系，
    它们都是随机来自于原本基因组中某个位置的短序列而已。

    需要把这一大堆短序列撸顺，一个一个去跟该物种的参考基因组比肩，
    找到每一条read在基因组上的位置，然后按顺序排列好，这个过程就称之为 测序数据的对比

    参考基因组，该物种的标准参考物

### 流程的搭建
    参考基因组流程的搭建
    参考序列进行Burrows Wheeler变换(wiki:块排序压缩)
    以便能够在序列对比时快速的搜索和定位

#### 参考基因组的索引
    这其实是在为参考序列进行Burrows Wheeler变换(wiki：块排序压缩)


    双末端测序(Pair-End Sequencing,PE测序)
    单末端测序(Single End Sequencing,SE测序)
    
### 测序
![avatar](./../images/processdure.jpg)   

    这一步我们也是使用samtools完成的

### 去除重复序列
    准确来说是去除PCR重复序列

-   DNA在打断的那一步会发生一些损失，主要表现是会引发一些碱基发生颠倒变换，带来变异
    -   PCR扩增会放大这个差异
-   PCR反应过程中也会带来新的碱基错误。
-   对于真实的变异，PCR反应可能对包含某一个碱基的DNA模板扩增的更加剧烈(PCR Bias)
    -   如果反应体系是对含有reference allele的模板扩增偏向强烈，那么变异碱基的信息会变小，从而导致假阴
----
    PCR对真实的变异检测和个体的基因型判断都有不好的影响。
    GATK、Samtools、Platpus等利用贝叶斯原理的变异检测算法都是认为所用的序列数据都不是重复序列。

    所以一般采用PCR-Free的测序方案

### 局部重对比
![avatar](./../images/sortedOnlocal.jpg)       
    局部重对比的目的是：将BWA对比过程中所发现有潜在序列插入或者序列删除(insertion 和 deletion)
    ,简称Indel；的区域进行重新校正。

    

