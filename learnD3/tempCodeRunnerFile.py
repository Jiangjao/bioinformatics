from collections import defaultdict
from types import FunctionType
import copy